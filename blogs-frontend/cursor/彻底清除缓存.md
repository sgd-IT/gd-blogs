# 彻底清除缓存 - 服务器端已更新但浏览器还是旧版本

## 问题确认
- ✅ 服务器端已更新（curl 测试找到中文）
- ✅ 构建产物包含中文
- ✅ 服务正常运行
- ❌ 浏览器显示旧版本

## 可能的原因

1. **静态资源（JS/CSS）被浏览器缓存**
2. **Nginx 反向代理缓存**
3. **Service Worker 缓存**
4. **CDN 缓存**

## 解决方案

### 方案一：检查 Nginx 配置（如果有反向代理）

```bash
# 检查 Nginx 站点配置
ls -la /www/server/panel/vhost/nginx/

# 查看具体配置
cat /www/server/panel/vhost/nginx/*.conf | grep -A 20 "119.91.150.19"

# 检查是否有缓存配置
grep -r "proxy_cache\|expires\|cache" /www/server/nginx/conf/
```

### 方案二：清除 Nginx 缓存（如果有）

```bash
# 清除 Nginx 缓存目录
rm -rf /www/server/nginx/cache/*
rm -rf /tmp/nginx_cache/*

# 重启 Nginx
nginx -s reload
```

### 方案三：检查静态资源缓存头

Next.js 默认会设置缓存头。可以检查：

```bash
# 检查静态资源的响应头
curl -I http://localhost:3000/_next/static/

# 检查 HTML 的响应头
curl -I http://localhost:3000/
```

### 方案四：强制清除浏览器缓存（最彻底）

1. **完全清除浏览器数据**：
   - 按 `Ctrl + Shift + Delete`
   - 选择"所有时间"
   - 勾选所有选项：
     - 浏览记录
     - Cookie 和其他网站数据
     - 缓存的图片和文件
     - 密码和其他登录数据
     - 自动填充表单数据
   - 点击"清除数据"

2. **使用开发者工具禁用缓存**：
   - 按 `F12` 打开开发者工具
   - 切换到 "Network"（网络）标签
   - 勾选 "Disable cache"（禁用缓存）
   - 保持开发者工具打开
   - 刷新页面

3. **检查 Service Worker**：
   - 按 `F12` 打开开发者工具
   - 切换到 "Application"（应用）标签
   - 左侧找到 "Service Workers"
   - 如果有注册的 Service Worker，点击 "Unregister"（注销）
   - 然后清除缓存

### 方案五：使用不同的浏览器或设备测试

- 使用另一个浏览器（Chrome、Firefox、Edge）
- 使用手机浏览器访问
- 使用无痕模式

### 方案六：检查是否有多个域名/IP

确认访问的是正确的地址：
- `http://119.91.150.19`（IP 地址）
- 如果有域名，也检查域名访问

### 方案七：添加缓存破坏参数

在 URL 后添加随机参数强制刷新：
```
http://119.91.150.19/?v=20250115
```

## 一键排查脚本

```bash
cd /www/wwwroot/gdblogs/frontend

echo "=== 1. 检查源码 ==="
grep "你好，我是" src/components/desktop/OrbitingIntroduction.tsx

echo "=== 2. 检查构建产物 ==="
grep -r "你好，我是" .next/static/ 2>/dev/null | head -3

echo "=== 3. 检查实际返回 ==="
curl -s http://localhost:3000 | grep -o "你好，我是" | head -1

echo "=== 4. 检查构建时间 ==="
ls -lh .next/ | head -5

echo "=== 5. 检查 Nginx 配置（如果有）==="
grep -r "proxy_cache\|expires" /www/server/nginx/conf/ 2>/dev/null | head -5

echo "=== 6. 检查响应头 ==="
curl -I http://localhost:3000/ 2>&1 | grep -i "cache\|expires"
```

## 如果还是不行

可能需要：
1. 检查是否有 CDN（如 Cloudflare）
2. 检查 DNS 是否指向正确的服务器
3. 等待一段时间让缓存过期
4. 或者修改 Next.js 配置，禁用静态资源缓存（不推荐）
