# 解决端口 3000 被占用问题

## 快速查找占用端口的进程

```bash
# 方法一：使用 lsof（如果已安装）
lsof -i :3000

# 方法二：使用 netstat
netstat -tulpn | grep 3000

# 方法三：使用 ss（推荐，更现代）
ss -tulpn | grep 3000

# 方法四：使用 fuser（如果已安装）
fuser 3000/tcp
```

## 找到进程后，杀掉它

```bash
# 如果找到了进程ID（PID），例如是 12345
kill -9 12345

# 或者使用 pkill（根据进程名）
pkill -f "next start"
pkill -f "node.*3000"

# 或者强制杀掉所有 node 进程（谨慎使用）
pkill -9 node
```

## 一键查找并杀掉

```bash
# 查找占用 3000 端口的进程并显示详细信息
lsof -i :3000

# 或者使用这个命令直接杀掉
lsof -ti :3000 | xargs kill -9

# 如果 lsof 不可用，使用这个：
netstat -tulpn | grep 3000 | awk '{print $7}' | cut -d'/' -f1 | xargs kill -9
```

## 检查是否有多个 Next.js 进程

```bash
# 查看所有 node 进程
ps aux | grep node

# 查看所有 npm 进程
ps aux | grep npm

# 查看所有 next 相关进程
ps aux | grep next
```

## 完整解决步骤

```bash
# 1. 查找占用端口的进程
ss -tulpn | grep 3000

# 2. 如果看到类似这样的输出：
# tcp   LISTEN  0  128  :::3000  :::*  users:(("node",pid=12345,fd=18))
# 记下 PID（这里是 12345）

# 3. 杀掉进程
kill -9 12345

# 4. 再次检查端口是否释放
ss -tulpn | grep 3000

# 5. 如果端口已释放，重新启动服务
cd /www/wwwroot/gdblogs/blogs-frontend
npm run start
```

## 防止端口被占用的方法

### 方法一：使用不同的端口

```bash
# 临时使用其他端口
PORT=3001 npm run start

# 或者在 package.json 中修改 start 脚本
# "start": "next start -p 3001"
```

### 方法二：确保进程正确关闭

```bash
# 使用 Ctrl+C 停止前台进程
# 或者找到进程并正确关闭
```

## 常见原因

1. **之前的进程没有正确关闭**：可能是 PM2 或其他进程管理器留下的
2. **多个服务实例**：可能同时启动了多个 Next.js 服务
3. **其他应用占用**：可能有其他应用也在使用 3000 端口
