# 深度排查 - 为什么还是显示旧版本

## 完整排查步骤

### 第一步：检查构建产物

```bash
cd /www/wwwroot/gdblogs/frontend

# 1. 检查构建时间
ls -lh .next/

# 2. 检查构建 ID
cat .next/BUILD_ID

# 3. 检查构建产物是否包含中文
grep -r "你好，我是" .next/static/ 2>/dev/null | head -5

# 4. 检查源码
grep "你好，我是" src/components/desktop/OrbitingIntroduction.tsx
```

### 第二步：检查是否有多个服务实例

```bash
# 检查所有占用 3000 端口的进程
ss -tulpn | grep 3000

# 检查所有 node 进程
ps aux | grep -E "node|next|npm" | grep -v grep

# 检查 PM2 进程
pm2 list
```

### 第三步：强制重新构建

```bash
cd /www/wwwroot/gdblogs/frontend

# 1. 停止服务（在宝塔面板中停止）

# 2. 删除旧构建
rm -rf .next

# 3. 重新构建
npm run build

# 4. 验证构建结果
grep -r "你好，我是" .next/static/ 2>/dev/null | head -5

# 5. 重启服务（在宝塔面板中启动）
```

### 第四步：检查实际返回的 HTML

```bash
# 获取完整的 HTML 响应
curl http://localhost:3000 > /tmp/response.html

# 检查是否包含中文
grep "你好，我是" /tmp/response.html

# 检查是否包含英文（旧版本）
grep "MY NAME IS" /tmp/response.html
```

### 第五步：检查 Next.js 缓存

```bash
cd /www/wwwroot/gdblogs/frontend

# 清除 Next.js 缓存
rm -rf .next/cache

# 重新构建
npm run build
```
